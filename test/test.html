<head>
  <meta property="og:title" content="VenSoeng Story"/>
  <meta property="og:description" content="Hello! I'm VenSoeng, a passionate and dedicated developer with a strong focus on web development, mobile app development." />
  <meta property="og:image" itemprop="image" content="<?=getBaseUrl('')?>images/og.jpg"/>
  <meta property="og:image" itemprop="image" content="<?=getBaseUrl('')?>profile1200_360.jpg"/>
  <meta property="og:url" content="http://vensoeng.free.nf/"/>
  <meta property="og:type" content="website"/>
  <meta property="og:image:secure_url" content="<?=getBaseUrl('')?>images/og.jpg">
  <meta property="og:image:secure_url" content="<?=getBaseUrl('')?>images/profile1200_360.jpg">
  <meta property="profile:username" content="vensoeng">
  <meta name="twitter:image" content="<?=getBaseUrl('')?>images/og.jpg"/>
  <meta name="twitter:image" content="<?=getBaseUrl('')?>images/profile1200_360.jpg"/>
  <meta name="twitter:description" content="Hello! I'm VenSoeng.">
  <meta property="snapchat:sticker" content="<?=getBaseUrl('')?>images/og.jpg">
  <meta property="snapchat:sticker" content="<?=getBaseUrl('')?>images/profile1200_360.jpg">
  <link rel="canonical" href="http://vensoeng.free.nf/">
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="515" />
  <meta property="og:image:type" content="image/jpg">
  <meta property="og:locale" content="km_KH">
  <meta property="og:site_name" content="vensoeng">
  <meta name="msapplication-TileImage" content="<?=getBaseUrl('')?>images/og.jpg">
  <meta name="msapplication-TileImage" content="<?=getBaseUrl('')?>images/profile1200_360.jpg">

  <b:if cond='data:blog.postImageUrl'>
    <meta expr:content='resizeImage(data:blog.postImageUrl, 0)' property='og:image'/>
    <b:else/>
    <meta content="<?=getBaseUrl('')?>images/og.jpg" property='og:image'/>
    <meta content="<?=getBaseUrl('')?>images/profile1200_360.jpg" property='og:image'/>
  </b:if>  
</head>

<head>
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="VenSoeng Story"/>
  <meta property="og:description" content="Hello! I'm VenSoeng, a passionate and dedicated developer with a strong focus on web development, mobile app development."/>
  <meta property="og:url" content="http://vensoeng.free.nf/"/>
  <meta property="og:type" content="website"/>
  <meta property="og:locale" content="km_KH"/>
  <meta property="og:site_name" content="vensoeng"/>

  <!-- Image Tags -->
  <meta property="og:image" content="<?=getBaseUrl('')?>images/og.jpg"/>
  <meta property="og:image:secure_url" content="<?=getBaseUrl('')?>images/og.jpg"/>
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="515"/>
  <meta property="og:image:type" content="image/jpg"/>

  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="VenSoeng Story"/>
  <meta name="twitter:description" content="Hello! I'm VenSoeng, a passionate and dedicated developer with a strong focus on web development, mobile app development."/>
  <meta name="twitter:image" content="<?=getBaseUrl('')?>images/og.jpg"/>

  <!-- Conditional Image Handling for Blogger -->
  <b:if cond='data:blog.postImageUrl'>
    <meta expr:content='resizeImage(data:blog.postImageUrl, 0)' property='og:image'/>
  </b:if>
  
  <!-- Fallback Image Tags -->
  <meta content="<?=getBaseUrl('')?>images/og.jpg" property='og:image'/>
  
  <!-- Canonical Link -->
  <link rel="canonical" href="http://vensoeng.free.nf/"/>

  <!-- Other Meta Tags -->
  <meta property="profile:username" content="vensoeng"/>
  <meta name="msapplication-TileImage" content="<?=getBaseUrl('')?>images/og.jpg"/>
</head>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VenSoeng - <?=$title?></title>
  <!-- this is favicon  -->
  <link rel="shortcut icon" href="<?=getBaseUrl('')?>images/favicon.png" type="image/x-icon">
  <!-- ---------  -->
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="VenSoeng Story"/>
  <meta property="og:description" content="Hello! I'm VenSoeng, a passionate and dedicated developer with a strong focus on web development, mobile app development."/>
  <meta property="og:url" content="http://vensoeng.free.nf/"/>
  <meta property="og:type" content="website"/>
  <meta property="og:locale" content="km_KH"/>
  <meta property="og:site_name" content="vensoeng"/>

  <!-- Image Tags -->
  <meta property="og:image" content="<?=getBaseUrl('')?>images/og.jpg"/>
  <meta property="og:image:secure_url" content="<?=getBaseUrl('')?>images/og.jpg"/>
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="515"/>
  <meta property="og:image:type" content="image/jpg"/>

  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="VenSoeng Story"/>
  <meta name="twitter:description" content="Hello! I'm VenSoeng, a passionate and dedicated developer with a strong focus on web development, mobile app development."/>
  <meta name="twitter:image" content="<?=getBaseUrl('')?>images/og.jpg"/>

  <!-- Conditional Image Handling for Blogger -->
  <b:if cond='data:blog.postImageUrl'>
      <meta expr:content='resizeImage(data:blog.postImageUrl, 0)' property='og:image'/>
  </b:if>
  
  <!-- Fallback Image Tags -->
  <meta content="<?=getBaseUrl('')?>images/og.jpg" property='og:image'/>
  
  <!-- Canonical Link -->
  <link rel="canonical" href="http://vensoeng.free.nf/"/>

  <!-- Other Meta Tags -->
  <meta property="profile:username" content="vensoeng"/>
  <meta name="msapplication-TileImage" content="<?=getBaseUrl('')?>images/og.jpg"/>
  <!--  -->
  <link rel="stylesheet" href="<?=getBaseUrl('')?>css/main.css?v=<?php echo time(); ?>">
  <link rel="stylesheet" href="<?=getBaseUrl('')?>css/header.css?v=<?php echo time(); ?>">
  <link rel="stylesheet" href="<?=getBaseUrl('')?>css/home.css?v=<?php echo time(); ?>">
  <link rel="stylesheet" href="<?=getBaseUrl('')?>css/dashbaord.css?v=<?php echo time(); ?>">
  <!-- this is for icon  -->
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- this is oas animation link css  -->
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <!-- this is for insert style  -->
  <?=$style?>
</head>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VenSoeng - <?= htmlspecialchars($title, ENT_QUOTES, 'UTF-8') ?></title>
  
  <!-- Favicon -->
  <link rel="shortcut icon" href="<?=getBaseUrl('')?>images/favicon.png" type="image/png">
  <link rel="icon" href="<?=getBaseUrl('')?>images/favicon.png" type="image/png" sizes="307x307">

  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="VenSoeng Story"/>
  <meta property="og:description" content="Hello! I'm VenSoeng, a passionate and dedicated developer with a strong focus on web development, mobile app development."/>
  <meta property="og:url" content="http://vensoeng.free.nf/"/>
  <meta property="og:type" content="website"/>
  <meta property="og:locale" content="km_KH"/>
  <meta property="og:site_name" content="vensoeng"/>

  <!-- Image Tags -->
  <meta property="og:image" content="<?=getBaseUrl('')?>images/og.jpg"/>
  <meta property="og:image:secure_url" content="<?=getBaseUrl('')?>images/og.jpg"/>
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="515"/>
  <meta property="og:image:type" content="image/jpg"/>

  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="VenSoeng Story"/>
  <meta name="twitter:description" content="Hello! I'm VenSoeng, a passionate and dedicated developer with a strong focus on web development, mobile app development."/>
  <meta name="twitter:image" content="<?=getBaseUrl('')?>images/og.jpg"/>

  <!-- Canonical Link -->
  <link rel="canonical" href="http://vensoeng.free.nf/"/>

  <!-- Other Meta Tags -->
  <meta property="profile:username" content="vensoeng"/>
  <meta name="msapplication-TileImage" content="<?=getBaseUrl('')?>images/og.jpg"/>

  <!-- Conditional Image Handling for Blogger -->
  <?php if (!empty($data['blog']['postImageUrl'])): ?>
      <meta property="og:image" content="<?=resizeImage($data['blog']['postImageUrl'], 0)?>"/>
  <?php else: ?>
      <meta property="og:image" content="<?=getBaseUrl('')?>images/og.jpg"/>
  <?php endif; ?>
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="<?=getBaseUrl('')?>css/main.css?v=<?php echo time(); ?>">
  <link rel="stylesheet" href="<?=getBaseUrl('')?>css/header.css?v=<?php echo time(); ?>">
  <link rel="stylesheet" href="<?=getBaseUrl('')?>css/home.css?v=<?php echo time(); ?>">
  <link rel="stylesheet" href="<?=getBaseUrl('')?>css/dashbaord.css?v=<?php echo time(); ?>">

  <!-- Icons and Animations -->
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

  <!-- Insert Additional Styles -->
  <?= $style ?>
</head>

<div class="main-loader">
  <div class="loader-container">
      <div class="loader">
          <div class="inner-circle"></div>
      </div>
      <p>Please wait</p>
  </div>
</div>
<div class="profile icon icon-ra">
  <?php
      if(file_exists('storage/upload/'.$getUser[$userDetail->profile]))
      { ?>
          <img class="img-c"
              loading="lazy"
              srcset="
              <?=getBaseUrl('storage/upload/'.$getUser[$userDetail->profile])?>?width=100? 100w, 
              <?=getBaseUrl('storage/upload/'.$getUser[$userDetail->profile])?>?width=200? 200w, 
              <?=getBaseUrl('storage/upload/'.$getUser[$userDetail->profile])?>?width=400? 400w, 
              <?=getBaseUrl('storage/upload/'.$getUser[$userDetail->profile])?>?width=800? 800w, 
              <?=getBaseUrl('storage/upload/'.$getUser[$userDetail->profile])?>?width=1000? 1000w, 
              <?=getBaseUrl('storage/upload/'.$getUser[$userDetail->profile])?>?width=1200? 1200w, 
              "
              sizes="(max-width: 800px) 100vw, 50vw" 
              decoding="async"
              fetchPriority = "high"
              effect="blur"
          alt="">
      <?php
          }else{ ?>
          <h2 class="notfound" style="color: var(--sg-main-bg);font-size: 1.3rem"><?=substr($getUser[$userDetail->first_name].$getUser[$userDetail->last_name], 0,1)?></h2>
      <?php }
  ?> 
</div>
<div class="text">
  <h2><?=$getUser[$userDetail->first_name].$getUser[$userDetail->last_name]?></h2>
  <h3><span><i class="fa-solid fa-link"></i>/</span><?=$getUser[$userDetail->first_name].$getUser[$userDetail->last_name]?></h3>
</div>

<?php

session_start();

require 'database/index.php';
require 'database/ui/index.php';
include 'app/config/functions.php';
require 'app/model/tb_user.php';
require 'app/model/user_detail.php';
require 'app/model/tb_post_type.php';
require 'app/model/tb_content.php';
require 'app/model/tb_follower.php';
require 'app/model/tb_reacte.php';

use App\Model\User\User as User;
use App\Model\UserDetail\UserDetail as UserDetail;
use App\Model\Follower\Follower as Follower;
use App\Model\Content\Content as Content;
use App\Model\Reacte\Reacte as Reacte;

$user = new User();
$userDetail = new UserDetail();
$content = new Content();
$reacte = new Reacte();

if (isset($_SESSION[$user->email]) && isset($_SESSION[$user->password])) {
    $user_id = $_SESSION[$user->id];

    $sql = "SELECT * FROM $userDetail->model
        INNER JOIN $user->model ON $userDetail->model.$userDetail->user_detail_id = $user->model.$user->id
        WHERE  $userDetail->model.$userDetail->user_detail_id = '$user_id'";
    $result = $conn->query($sql);

    if ($result && mysqli_num_rows($result) == 1) {
        $getUser = $result->fetch_assoc();
    }
}
// ================this is se csrf token not user edit code=========== 
if (empty($_SESSION['csrf_token'])) {
    $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
}
?>
<!DOCTYPE html>
<html lang="en">
<?php
    require 'app/views/layout/head.php'; 
?>
<body>
    <?php
        require 'app/views/layout/header.php';
    ?>
    <!-- this is form for reaction  -->
    <div class="form-reaction df-c form-fix">
        <div class="form-reaction-body">
            <div class="form-reaction-body-con">
                <div class="head">
                    <ul class="df-l">
                        <li class="arrow">
                            <div class="icon icon-ra icon-sm curs-p"
                                onclick="document.querySelector('.form-reaction').classList.remove('form-reaction-active')">
                                <i class='bx bx-arrow-back'></i>
                            </div>
                        </li>
                        <li class="i-reaction i-reaction-active df-l">
                            <div class="btn icon icon-ra icon-sm curs-p">
                                <p>All</p>
                                <span>8</span>
                            </div>
                        </li>
                        <li class="i-reaction df-l">
                            <div class="btn icon icon-ra icon-sm curs-p">
                                <i class='bx bxs-like'></i>
                                <span>5</span>
                            </div>
                        </li>
                        <li class="i-reaction df-l">
                            <div class="btn icon icon-ra icon-sm curs-p">
                                <i class='bx bxs-bookmarks'></i>
                                <span>3</span>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="reate">
                    <ul>
                        <li class="df-s">
                            <div class="user-profile df-l">
                                <a href="#" class="profile icon icon-ra">
                                    <img class="img-c" src="<?= getBaseUrl('') ?>public/images/profile.jpg" alt="">
                                </a>
                                <div class="text">
                                    <a href="#">
                                        <h2>VenSoeng</h2>
                                    </a>
                                    <p>@vensoeng001</p>
                                </div>
                            </div>
                            <div class="btn icon icon-ra icon-sm">
                                <i class='bx bxs-like'></i>
                            </div>
                        </li>
                        <li class="df-s">
                            <div class="user-profile df-l">
                                <a href="#" class="profile icon icon-ra">
                                    <img class="img-c" src="<?= getBaseUrl('') ?>public/images/profile.jpg" alt="">
                                </a>
                                <div class="text">
                                    <a href="#">
                                        <h2>VenSoeng</h2>
                                    </a>
                                    <p>@vensoeng001</p>
                                </div>
                            </div>
                            <div class="btn icon icon-ra icon-sm">
                                <i class='bx bxs-bookmarks'></i>
                            </div>
                        </li>
                        <li class="df-s">
                            <div class="user-profile df-l">
                                <a href="#" class="profile icon icon-ra">
                                    <img class="img-c" src="<?= getBaseUrl('') ?>public/images/profile.jpg" alt="">
                                </a>
                                <div class="text">
                                    <a href="#">
                                        <h2>VenSoeng</h2>
                                    </a>
                                    <p>@vensoeng001</p>
                                </div>
                            </div>
                            <div class="btn icon icon-ra icon-sm">
                                <i class='bx bxs-like'></i>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="foot df-l">
                    <p>This is post by <strong>VenSoeng</strong></p>
                </div>
            </div>
        </div>
        <div class="reat-bg form-fix"></div>
    </div>
    <!-- -------------this  is form popup---------- -->
    <div class="form-pop form-fix df-c">
        <div class="form-pop-body">
            <div class="form-pop-body-con">
                <div class="head df-s">
                    <a class="icon icon-ra icon-sm curs-p" onclick="toggleClassSmall('.form-pop','form-pop-active')">
                        <i class="fa-solid fa-xmark"></i>
                    </a>
                    <h2>Login linkme to get better</h2>
                </div>
                <blockquote>
                    <p>Logging in unlocks exclusive content, personalized recommendations, and seamless access to all
                        our services. Stay updated and enjoy enhanced security—join our community today!</p>
                </blockquote>
                <div class="foot">
                    <a href="signup/" class="btn icon icon-ra icon-sm">
                        Signup for free
                    </a>
                    <a href="#" class="btn icon icon-ra icon-sm">
                        Find out more
                    </a>
                </div>
            </div>
        </div>
        <div class="form-pop-bg form-fix"></div>
    </div>
    <!-- this is content of page  -->
    <main class="web-main db-c">
        <div class="web-main-body df-l">
            <!-- this is aside left  -->
            <?php
                require 'app/views/layout/aside_left.php';
            ?>
            <!-- this is content with aside -->
            <div class="web-con">
                <div class="web-con-body df-c">
                    <!-- this is for user post  -->
                    <div class="web-post">
                        <div class="user-post">
                            <div class="user-post-body">
                                <!-- this is header of content it show user profile -->
                                <?php
                                if (isset($_SESSION[$user->email]) && isset($_SESSION[$user->password])) {
                                    ?>
                                    <nav class="head-user head-user-active">
                                        <div class="scroll-x df-l">
                                            <?php
                                            if ($getUser) {
                                                ?>
                                                <a class="list" style="--bg-: url('')">
                                                    <div class="icon icon-ra profile">
                                                        <!-- <img src="" alt=""> -->
                                                    </div>
                                                    <h2>Create</h2>
                                                </a>
                                                <?php
                                            }
                                            ?>
                                            <?php

                                            $follower = new Follower();

                                            $sql = "
                                                SELECT
                                                    u.{$userDetail->user_detail_id} AS user_id,
                                                    f.{$follower->id} AS follow_id,
                                                    c.{$content->id} AS post_id,
                                                    u.{$userDetail->first_name},
                                                    u.{$userDetail->last_name},
                                                    u.{$userDetail->profile},
                                                    c.{$content->user_post_id},
                                                    c.{$content->post_status},
                                                    c.{$content->post_title},
                                                    c.{$content->post_des},
                                                    c.{$content->post_img},
                                                    c.{$content->created_at},
                                                    c.{$content->updated_at},
                                                    f.*
                                                FROM {$follower->model} f
                                                INNER JOIN {$userDetail->model} u
                                                    ON f.{$follower->user_follower_id} = u.{$userDetail->user_detail_id}
                                                INNER JOIN {$content->model} c
                                                    ON c.{$content->user_post_id} = u.{$userDetail->user_detail_id} AND c.{$content->post_status} = 1
                                                WHERE f.{$follower->user_sand_follower_id} = '$user_id'
                                                AND DATE(c.{$content->created_at}) = CURDATE()
                                                ORDER BY (c.{$content->user_post_id} = '$user_id') DESC, c.{$content->created_at} DESC";

                                            $result = $conn->query($sql);

                                            if ($result && mysqli_num_rows($result) == 0) {
                                                $sql = "
                                                    SELECT
                                                        c.{$content->id} AS post_id,
                                                        u.{$userDetail->first_name},
                                                        u.{$userDetail->last_name},
                                                        u.{$userDetail->profile},
                                                        c.{$content->user_post_id},
                                                        c.{$content->post_status},
                                                        c.{$content->post_title},
                                                        c.{$content->post_des},
                                                        c.{$content->post_img},
                                                        c.{$content->created_at},
                                                        c.{$content->updated_at}
                                                    FROM {$content->model} c
                                                    INNER JOIN {$userDetail->model} u
                                                        ON c.{$content->user_post_id} = u.{$userDetail->user_detail_id}
                                                    WHERE (c.{$content->user_post_id} = '$user_id' AND DATE(c.{$content->created_at}) = CURDATE())
                                                ";
                                                $result = $conn->query($sql);
                                            }
                                            if ($result) {
                                                foreach ($result as $index => $item) {
                                                    ?>
                                                    <a href="#" class="list data-list" data-name="user-profile">
                                                        <div class="icon icon-ra profile">
                                                            <?php
                                                            if (trim($item[$content->post_img]) !== '' && $item[$content->post_img] !== null) {
                                                                ?>
                                                                <img class="img-c" loading="lazy" srcset="
                                                                        <?= getBaseUrl('storage/upload/' . $item[$content->post_img]) ?>?width=100? 100w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$content->post_img]) ?>?width=200? 200w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$content->post_img]) ?>?width=400? 400w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$content->post_img]) ?>?width=800? 800w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$content->post_img]) ?>?width=1000? 1000w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$content->post_img]) ?>?width=1200? 1200w, 
                                                                        " sizes="(max-width: 800px) 100vw, 50vw"
                                                                    decoding="async" fetchPriority="high" effect="blur" alt="">
                                                                <?php
                                                            } else {
                                                                ?>
                                                                <img class="img-c" loading="lazy" srcset="
                                                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=100? 100w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=200? 200w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=400? 400w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=800? 800w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=1000? 1000w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=1200? 1200w, 
                                                                        " sizes="(max-width: 800px) 100vw, 50vw"
                                                                    decoding="async" fetchPriority="high" effect="blur" alt="">
                                                                <?php
                                                            }
                                                            ?>
                                                        </div>
                                                        <h2>
                                                            <?= $item[$content->user_post_id] == $user_id ? 'Your post' : $item[$userDetail->first_name] . $item[$userDetail->last_name] ?>
                                                        </h2>
                                                    </a>
                                                    <?php
                                                }
                                            } else {
                                                ?>
                                                <a class="list" href="https://web.facebook.com/profile.php?id=100041547633244"
                                                    style="--bg-: url('')">
                                                    <div class="icon icon-ra profile">
                                                        <h2>Error DB</h2>
                                                    </div>
                                                    <h2>Our Soppurt</h2>
                                                </a>
                                                <?php
                                            }
                                            ?>

                                        </div>
                                    </nav>
                                    <?php
                                }
                                ?>
                                <!-- ----------------------this is post of user----------------------  -->
                                <ul>
                                    <?php

                                    if (isset($_SESSION[$user->email]) && isset($_SESSION[$user->password])) {
                                        $sql = "
                                                SELECT
                                                    c.{$content->id} AS content_id,
                                                    d.{$userDetail->first_name},
                                                    d.{$userDetail->last_name},
                                                    d.{$userDetail->profile},
                                                    d.{$userDetail->user_detail_id},
                                                    c.{$content->created_at} AS content_created_at,
                                                    u.{$user->verify_status},
                                                    u.{$user->user_name},
                                                    c.*,
                                                    r.*,
                                                    (SELECT COUNT(*) FROM {$reacte->model} r1 WHERE r1.{$reacte->post_id} = c.{$content->id} AND r1.{$reacte->reate_type} = 1) AS reacte_link,
                                                    (SELECT COUNT(*) FROM {$reacte->model} r2 WHERE r2.{$reacte->post_id} = c.{$content->id} AND r2.{$reacte->reate_type} = 2) AS reacte_save
                                                FROM {$content->model} c
                                                LEFT JOIN {$reacte->model} r
                                                    ON r.{$reacte->post_id} = c.{$content->id}
                                                    AND r.{$reacte->user_reacte_id} = '$user_id'
                                                INNER JOIN {$userDetail->model} d
                                                    ON c.{$content->user_post_id} = d.{$userDetail->user_detail_id}
                                                INNER JOIN {$user->model} u
                                                    ON c.{$content->user_post_id} = u.{$user->id}
                                                WHERE r.{$reacte->post_id} IS NULL 
                                                AND c.{$content->post_status} = 1
                                                AND DATE(c.{$content->created_at}) BETWEEN CURDATE() - INTERVAL 2 DAY AND CURDATE()
                                                ORDER BY c.{$content->created_at} DESC
                                            ";

                                        $postResult = $conn->query($sql);

                                        if ($postResult && $postResult->num_rows == 0) {
                                            $sql = "
                                                    SELECT
                                                        c.{$content->id} AS content_id,
                                                        d.{$userDetail->first_name},
                                                        d.{$userDetail->last_name},
                                                        d.{$userDetail->profile},
                                                        d.{$userDetail->user_detail_id},
                                                        c.{$content->created_at} AS content_created_at,
                                                        u.{$user->verify_status},
                                                        u.{$user->user_name},
                                                        c.*,
                                                        r.*,
                                                        (SELECT COUNT(*) FROM {$reacte->model} r1 WHERE r1.{$reacte->post_id} = c.{$content->id} AND r1.{$reacte->reate_type} = 1) AS reacte_link,
                                                        (SELECT COUNT(*) FROM {$reacte->model} r2 WHERE r2.{$reacte->post_id} = c.{$content->id} AND r2.{$reacte->reate_type} = 2) AS reacte_save
                                                    FROM {$content->model} c
                                                    LEFT JOIN {$reacte->model} r
                                                        ON r.{$reacte->post_id} = c.{$content->id}
                                                        AND r.{$reacte->user_reacte_id} = '$user_id'
                                                    INNER JOIN {$userDetail->model} d
                                                        ON c.{$content->user_post_id} = d.{$userDetail->user_detail_id}
                                                    INNER JOIN {$user->model} u
                                                        ON c.{$content->user_post_id} = u.{$user->id}
                                                    WHERE r.{$reacte->post_id} IS NULL
                                                    AND c.{$content->post_status} = 1
                                                    ORDER BY c.{$content->created_at} DESC
                                                ";

                                            $postResult = $conn->query($sql);
                                        }
                                    } else {
                                        $sql = "SELECT
                                                c.{$content->id} AS content_id,
                                                c.{$content->created_at} AS content_created_at,
                                                d.{$userDetail->first_name},
                                                d.{$userDetail->last_name},
                                                d.{$userDetail->profile},
                                                d.{$userDetail->user_detail_id},
                                                u.{$user->verify_status},
                                                u.{$user->user_name},
                                                c.*,
                                                r.*,
                                                (SELECT COUNT(*) FROM {$reacte->model} r1 WHERE r1.{$reacte->post_id} = c.{$content->id} AND r1.{$reacte->reate_type} = 1) AS reacte_link,
                                                (SELECT COUNT(*) FROM {$reacte->model} r2 WHERE r2.{$reacte->post_id} = c.{$content->id} AND r2.{$reacte->reate_type} = 2) AS reacte_save
                                                FROM {$content->model} c
                                                LEFT JOIN {$reacte->model} r 
                                                    ON r.{$reacte->post_id} = c.{$content->id}
                                                INNER JOIN {$userDetail->model} d
                                                    ON c.{$content->user_post_id} = d.{$userDetail->user_detail_id}
                                                INNER JOIN {$user->model} u
                                                    ON c.{$content->user_post_id} = u.{$user->id}
                                                WHERE c.{$content->post_status} = '1'
                                                ORDER BY c.{$content->id} DESC";

                                        $postResult = $conn->query($sql);
                                    }
                                    if ($postResult) {
                                        foreach ($postResult as $index => $item) {
                                            ?>
                                            <li class="data_list">
                                                <div class="head df-s">
                                                    <div class="post-profile df-l">
                                                        <a href="/user/<?= $item[$user->user_name] ?>" class="profile">
                                                            <?php
                                                            if (file_exists('storage/upload/' . $item[$userDetail->profile])) { ?>
                                                                <img class="img-c" loading="lazy" srcset="
                                                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=100? 100w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=200? 200w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=400? 400w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=800? 800w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=1000? 1000w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=1200? 1200w, 
                                                                        " sizes="(max-width: 800px) 100vw, 50vw"
                                                                    decoding="async" fetchPriority="high" effect="blur" alt="">
                                                                <?php
                                                            } else { ?>
                                                                <h2 class="notfound"
                                                                    style="color: var(--sg-main-bg);font-size: 1.3rem">
                                                                    <?= substr($item[$userDetail->first_name] . $item[$userDetail->last_name], 0, 1) ?>
                                                                </h2>
                                                            <?php }
                                                            ?>
                                                        </a>
                                                        <a href="/user/<?= $item[$user->user_name] ?>" class="user-name">
                                                            <h2 style="width: max-content; max-width:100%; color:var(--sg-main-bg);"
                                                                class="<?= $item[$user->verify_status] == 1 ? 'ui-name text-be' : '' ?>">
                                                                <?= $item[$userDetail->first_name] . $item[$userDetail->last_name] ?>
                                                            </h2>
                                                            <p style="color:var(--sg-main-bg);">
                                                                <?= convertDate($item['content_created_at'], '', true) ?>
                                                                <?= $item[$content->post_status] == 1 ? '<i class="fa-solid fa-globe"></i>' : '<i class="fa-solid fa-lock"></i>' ?>
                                                            </p>
                                                        </a>
                                                    </div>
                                                    <div class="icon icon-ra icon-sm" data-name="btn-edit-content">
                                                        <i class="fa-solid fa-ellipsis"></i>
                                                    </div>
                                                </div>
                                                <?php
                                                if (trim($item[$content->post_title]) !== '' && trim($item[$content->post_img]) !== '') {
                                                    ?>
                                                    <div class="post-title">
                                                        <h2><?= $item[$content->post_title] ?></h2>
                                                    </div>
                                                    <?php
                                                }
                                                ?>
                                                <div class="post-img">
                                                    <ul>
                                                        <li>
                                                            <?php
                                                            if (trim($item[$content->post_img]) !== '' && $item[$content->post_img] !== null) {
                                                                if (file_exists('storage/upload/' . $item[$content->post_img])) {
                                                                    ?>
                                                                    <img loading="lazy" srcset="
                                                                        <?= getBaseUrl('storage/upload/' . $item[$content->post_img]) ?>?width=100? 100w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$content->post_img]) ?>?width=200? 200w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$content->post_img]) ?>?width=400? 400w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$content->post_img]) ?>?width=800? 800w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$content->post_img]) ?>?width=1000? 1000w, 
                                                                        <?= getBaseUrl('storage/upload/' . $item[$content->post_img]) ?>?width=1200? 1200w, 
                                                                        " sizes="(max-width: 800px) 100vw, 50vw"
                                                                        decoding="async" fetchPriority="high" effect="blur" alt="">
                                                                    <?php
                                                                }
                                                            } else if (trim($item[$content->post_title]) !== '') { ?>
                                                                    <div class="post-type-txt">
                                                                        <h2><?= $item[$content->post_title] ?></h2>
                                                                    </div>
                                                            <?php } else {
                                                                ?>
                                                                    <div class="post-type-txt">
                                                                        <h2><?= sanitizeContent($item[$content->post_des]) ?></h2>
                                                                    </div>
                                                                <?php
                                                            }
                                                            ?>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div class="post-feature">
                                                    <ul class="df-l">
                                                        <li class="df-c" data-name="addreacte">
                                                            <form action="/post/reacte/" method="POST" class="form-reacte">
                                                                <input type="hidden" name="csrf_token" value="<?= $_SESSION['csrf_token']; ?>" hidden>
                                                                <input type="text" name="action" class="txt-action" value="addreacte" hidden>
                                                                <input type="number" name="<?= $reacte->post_id ?>" value="<?= $item['content_id'] ?>" hidden>
                                                                <input type="number" name="<?= $userDetail->user_detail_id ?>" value="<?= $item[$userDetail->user_detail_id] ?>" hidden>
                                                                <input type="number" name="<?= $reacte->reate_type ?>" value="1" hidden>
                                                                <button class="icon icon-ra icon-ra-sm bg-n like">
                                                                    <i class='bx bx-like'></i>
                                                                </button>
                                                            </form>
                                                            <p class="text"><?= $item['reacte_link'] ?></p>
                                                        </li>
                                                        <li class="df-c" data-name="addreacte">
                                                            <form action="/post/reacte/" method="POST" class="form-reacte">
                                                                <input type="hidden" name="csrf_token" value="<?= $_SESSION['csrf_token']; ?>" hidden>
                                                                <input type="text" name="action" class="txt-action" value="addreacte" hidden>
                                                                <input type="number" name="<?= $reacte->post_id ?>" value="<?= $item['content_id'] ?>" hidden>
                                                                <input type="number" name="<?= $userDetail->user_detail_id ?>" value="<?= $item[$userDetail->user_detail_id] ?>" hidden>
                                                                <input type="number" name="<?= $reacte->reate_type ?>" value="2" hidden>
                                                                <button class="icon icon-ra icon-ra-sm bg-n save book">
                                                                    <i class='bx bx-bookmark'></i>
                                                                </button>
                                                            </form>
                                                            <p class="text"><?= $item['reacte_link'] ?></p>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div class="post-des">
                                                    <blockquote>
                                                        <?php
                                                        $sanitized_output = sanitizeContent($item[$content->post_des]);
                                                        ?>
                                                        <p><?= $sanitized_output ?></p>
                                                    </blockquote>
                                                </div>
                                                <div class="post-foot df-l">
                                                    <a href="#" class="btn icon icon-ra icon-sm curs-p">See reatetion</a>
                                                </div>
                                            </li>
                                            <?php
                                        }
                                    } else {
                                        // echo mysqli_error($conn);
                                    }
                                    ?>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- this is aside right  -->
                    <?php
                        require 'app/views/layout/aside_right.php';
                    ?>
                </div>
            </div>
        </div>
    </main>
    <!-- this is script user not authtion -->
    <?php
    if (!isset($_SESSION[$user->email]) && !isset($_SESSION[$user->password])) {
        ?>
        <script type="text/javascript">
            var formPopUp = document.querySelector('.form-pop');
            document.addEventListener('DOMContentLoaded', function () {
                setTimeout(function () {
                    formPopUp.classList.add('form-pop-active');
                }, 4000);
            });
        </script>
        <?php
    } else {
        ?>
        <script src="<?= getBaseUrl('public/js/function.js?v=' . time()) ?>"></script>
        <script src="<?= getBaseUrl('public/js/welcome.js?v=' . time()) ?>"></script>
        <?php
    }
    ?>
    <script type="text/javascript">
        //this is for add class active to list
        function addActiveClassTolist(mainClass, listClass, activeClass = "active") {
            var main = document.querySelector(mainClass);
            var list = main.querySelectorAll(listClass);
            list.forEach((e, i) => {
                e.addEventListener("click", function () {
                    list.forEach((ee) => {
                        ee.classList.remove(activeClass);
                    });
                    e.classList.add(activeClass);
                });
            });
        }
        addActiveClassTolist(".web-tablink .con ul", "li", "i-active");
        //this is add toggle class
        function toggleClass(mainClass, activeClass, removeClass = "") {
            var main = document.querySelector(mainClass);
            main.classList.add(activeClass);
            removeClass !== "" ? main.classList.remove(removeClass) : (removeClass = "");
        }
        function toggleClassSmall(main, active = "active") {
            document.querySelector(main).classList.toggle(active);
        }
        document.addEventListener('DOMContentLoaded', function(){
            var txtWidth = screen.width;
            if(txtWidth < 950){
                var head = document.head;
                head.innerHTML += `<link rel="stylesheet" href="<?= getBaseUrl('') ?>home_phone_screen.css?v=<?= time() ?>">`;
            }            
        });
    </script>
</body>
</html>

<nav class="head-user">
    <div class="scroll-x df-l">
        <!-- defules  -->
        <?php
        if (isset($_SESSION[$user->email]) && isset($_SESSION[$user->password]) && $_SESSION[$user->id] == $getUser[$userDetail->user_detail_id]) {
            ?>
            <a class="list">
                <div class="icon icon-ra profile curs-p"
                    style="--img: url('<?= getBaseUrl('storage/upload/' . $getUser[$userDetail->profile]) ?>');">
                    <h2 class="notfound df-c" style=""><i
                            class='bx bx-camera'></i></h2>
                </div>
                <h2>You</h2>
                <div class="form">
                    <button type="submit" class="btn">Create new</button>
                </div>
            </a>
            <?php
        } else if (isset($_SESSION[$user->email]) && isset($_SESSION[$user->password]) && $_SESSION[$user->id] !== $getUser[$user->id]) {
            $user_seccion_id = $_SESSION[$user->id];
            $user_id = $getUser[$userDetail->user_detail_id];

            $sql = "SELECT *,
                    CASE
                        WHEN $follower->user_follower_id = '$user_seccion_id' THEN 'back'
                        WHEN $follower->user_sand_follower_id = '$user_seccion_id' THEN 'sand'
                    END AS getText
                FROM $follower->model
                WHERE $follower->user_follower_id = '$user_id'
                OR $follower->user_sand_follower_id = '$user_id'";

            $result = $conn->query($sql);
            if ($result && $result->num_rows == 1) {
                $result = $result->fetch_assoc();

                if ($result['getText'] == 'sand') {
                    ?>
                        <a class="list">
                            <div class="icon icon-ra profile curs-p"
                                style="--img: url('<?= getBaseUrl('storage/upload/' . $getUser[$userDetail->profile]) ?>');">
                                <h2 class="notfound df-c" style=""></h2>
                            </div>
                            <h2>Creator</h2>
                            <form action="/user/" method="POST"
                                class="form-follow-back form-follow">
                                <button type="submit" class="btn">
                                    <span>unFolw</span>
                                    <span>Follow</span>
                                </button>
                            </form>
                        </a>
                    <?php
                } else if ($result['getText'] == 'back') {
                    ?>
                            <a class="list">
                                <div class="icon icon-ra profile curs-p"
                                    style="--img: url('<?= getBaseUrl('storage/upload/' . $getUser[$userDetail->profile]) ?>');">
                                    <img class="img-c"
                                        src="<?= getBaseUrl('storage/upload/' . $getUser[$userDetail->profile]) ?>"
                                        alt="">
                                </div>
                                <h2>Creator</h2>
                                <form action="/user/" method="POST"
                                    class="form-follow-back form-follow">
                                    <button type="submit" class="btn">
                                        <span>Accept</span>
                                        <span>delete</span>
                                    </button>
                                </form>
                            </a>
                    <?php
                } else {
                    ?>
                            <a class="list">
                                <div class="icon icon-ra profile curs-p">
                                    <img class="img-c"
                                        src="<?= getBaseUrl('storage/upload/' . $getUser[$userDetail->profile]) ?>"
                                        alt="">
                                </div>
                                <h2>Creator</h2>
                                <form action="/user/" method="POST"
                                    class="form-follow-back form-follow">
                                    <button type="submit" class="btn">
                                        <span>Follow</span>
                                        <span>unFolw</span>
                                    </button>
                                </form>
                            </a>
                    <?php
                }
            } else {
                ?>
                    <a class="list">
                        <div class="icon icon-ra profile curs-p">
                            <img class="img-c"
                                src="<?= getBaseUrl('storage/upload/' . $getUser[$userDetail->profile]) ?>"
                                alt="">
                        </div>
                        <h2>Creator</h2>
                        <form action="/user/" method="POST"
                            class="form-follow-back form-follow">
                            <button type="submit" class="btn">
                                <span>Follow</span>
                                <span>Unfolw</span>
                            </button>
                        </form>
                    </a>
                <?php
            }
            ?>
            <?php
        } else {
            ?>
                <a class="list">
                    <div class="icon icon-ra profile curs-p">
                        <img class="img-c"
                            src="<?= getBaseUrl('storage/upload/' . $getUser[$userDetail->profile]) ?>"
                            alt="">
                    </div>
                    <h2>Creator</h2>
                    <form action="/user/" method="POST"
                        class="form-follow-back form-follow">
                        <button type="submit" class="btn">
                            <span>Follow</span>
                            <span>Unfolw</span>
                        </button>
                    </form>
                </a>
            <?php
        }
        ?>
        <?php

        $user_id = $getUser[$userDetail->user_detail_id];

        $sql = "SELECT
                d.{$userDetail->user_detail_id} AS user_id,
                u.{$user->user_name},
                f.{$follower->id} AS follow_id,
                d.{$userDetail->first_name},
                d.{$userDetail->last_name},
                d.{$userDetail->profile},
                f.*
            FROM {$follower->model} f
            INNER JOIN {$userDetail->model} d
            ON f.{$follower->user_follower_id} = d.{$userDetail->user_detail_id}
            INNER JOIN {$user->model} u
            ON f.{$follower->user_follower_id} = u.{$user->id}
            WHERE f.{$follower->user_sand_follower_id} = '$user_id'";

        $result = $conn->query($sql);
        if ($result) {
            foreach ($result as $index => $item) {
                ?>
                <a href="<?= getBaseUrl('user/' . $item[$user->user_name]) ?>"
                    class="list follower-data">
                    <div
                        class="icon icon-ra profile <?= $item[$follower->follower_status] == 0 ? 'following' : 'follower' ?> curs-p">
                        <?php
                        if (file_exists('storage/upload/' . $item[$userDetail->profile])) { ?>
                            <img class="img-c" loading="lazy" srcset="
                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=100? 100w, 
                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=200? 200w, 
                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=400? 400w, 
                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=800? 800w, 
                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=1000? 1000w, 
                                        <?= getBaseUrl('storage/upload/' . $item[$userDetail->profile]) ?>?width=1200? 1200w, 
                                        "
                                sizes="(max-width: 800px) 100vw, 50vw"
                                decoding="async" fetchPriority="high" effect="blur"
                                alt="">
                            <?php
                        } else { ?>
                            <h2 class="notfound" style="font-size: 1.3rem">
                                <?= substr($getUser[$userDetail->first_name] . $getUser[$userDetail->last_name], 0, 1) ?>
                            </h2>
                        <?php }
                        ?>
                    </div>
                    <h2><?= $item[$userDetail->first_name] . $item[$userDetail->last_name] ?>
                    </h2>
                    <form
                        action="<?= getBaseUrl('user/' . $item[$user->user_name]) ?>"
                        method="POST" class="form-follow-back form-follow">
                        <button type="submit" class="btn">
                            <span>See profile</span>
                            <span>See profile</span>
                        </button>
                    </form>
                </a>
                <?php
            }
        }
        ?>
    </div>
</nav>